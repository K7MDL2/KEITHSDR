#******************************************************************************
# Generated by VisualTeensy (https:\\github.com\luni64\VisualTeensy)   {DateTime.Now.ToShortDateString()} {DateTime.Now.ToShortTimeString()}
#
# Board              Teensy 4.1
# USB Type           USB_MIDI_AUDIO_SERIAL
# CPU Speed          816 MHz (overclock)
# Optimize           Faster
# Keyboard Layout    US English
#
# #******************************************************************************
SHELL            := cmd.exe
export SHELL

SKETCH_NAME      := SDR_RA8875.ino

BOARD_ID         := TEENSY41
MCU              := imxrt1062

BUILDER_BASE     := "C:\Program Files (x86)\Arduino"
FLAGS            := -verbose=1 -warnings=all
FQBN             := teensy:avr:teensy41:usb=serialmidiaudio,speed=816,opt=o2std,keys=en-us
BUILD_PATH       := "C:\Users\${USERNAME}\Documents\GitHub\KEITHSDR\SDR_RA8875\.vsteensy\build"
BUILD_CACHE      := "C:\Users\${USERNAME}\Documents\GitHub\KEITHSDR\SDR_RA8875\.vsteensy\cache"
HARDWARE         := -hardware="C:\Program Files (x86)\Arduino\hardware"
TOOLS            := -tools="C:\Program Files (x86)\Arduino\tools-builder"

LIBRARIES        := -built-in-libraries="C:\Program Files (x86)\Arduino\libraries"
LIBRARIES        := -libraries="C:\Users\${USERNAME}\Documents\Arduino\libraries"
UPL_PJRC_B       := C:\PROGRA~2\Arduino\hardware\tools
UPL_TYCMD_B      := C:\PROGRA~1\TyTools
UPL_CLICMD_B     := 

TARGET_HEX       := $(BUILD_PATH)/$(SKETCH_NAME).hex

#******************************************************************************
# BINARIES
#******************************************************************************
BUILDER     := $(BUILDER_BASE)/arduino-builder
UPL_PJRC    := "$(UPL_PJRC_B)/teensy_post_compile" -test -file=$(SKETCH_NAME) -path=$(BUILD_PATH) -tools="$(UPL_PJRC_B)" -board=$(BOARD_ID) -reboot
UPL_TYCMD   := $(UPL_TYCMD_B)/tyCommanderC upload $(TARGET_HEX) --autostart --wait --multi
UPL_CLICMD  := $(UPL_CLICMD_B)/teensy_loader_cli -mmcu=$(MCU) -v $(TARGET_HEX) 

.PHONY:  all upload uploadTy uploadCLI clean 

all:  
	$(BUILDER) $(FLAGS) -build-path=$(BUILD_PATH) -build-cache=$(BUILD_CACHE) -fqbn=$(FQBN) $(HARDWARE) $(TOOLS) $(LIBRARIES) $(SKETCH_NAME)

upload: all
	$(UPL_PJRC)

uploadTy: all
	@$(UPL_TYCMD)

uploadCLI: all
	@$(UPL_CLICMD)

clean: 	
	@echo Cleaning user binaries...
	@if exist .vsteensy\build rd /s/q .vsteensy\build
	@md .vsteensy\build

	@if exist .vsteensy\cache rd /s/q .vsteensy\cache"
	@md .vsteensy\cache
	@echo done
